{"version":3,"sources":["parse.js"],"names":[],"mappings":"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","file":"parse-compiled.js","sourcesContent":["'use strict';\n\nvar utils = require('./utils');\n\nvar has = Object.prototype.hasOwnProperty;\n\nvar defaults = {\n    allowDots: false,\n    allowPrototypes: false,\n    arrayLimit: 20,\n    decoder: utils.decode,\n    delimiter: '&',\n    depth: 5,\n    parameterLimit: 1000,\n    plainObjects: false,\n    strictNullHandling: false\n};\n\nvar parseValues = function parseQueryStringValues(str, options) {\n    var obj = {};\n    var parts = str.split(options.delimiter, options.parameterLimit === Infinity ? undefined : options.parameterLimit);\n\n    for (var i = 0; i < parts.length; ++i) {\n        var part = parts[i];\n        var pos = part.indexOf(']=') === -1 ? part.indexOf('=') : part.indexOf(']=') + 1;\n\n        var key, val;\n        if (pos === -1) {\n            key = options.decoder(part);\n            val = options.strictNullHandling ? null : '';\n        } else {\n            key = options.decoder(part.slice(0, pos));\n            val = options.decoder(part.slice(pos + 1));\n        }\n        if (has.call(obj, key)) {\n            obj[key] = [].concat(obj[key]).concat(val);\n        } else {\n            obj[key] = val;\n        }\n    }\n\n    return obj;\n};\n\nvar parseObject = function parseObjectRecursive(chain, val, options) {\n    if (!chain.length) {\n        return val;\n    }\n\n    var root = chain.shift();\n\n    var obj;\n    if (root === '[]') {\n        obj = [];\n        obj = obj.concat(parseObject(chain, val, options));\n    } else {\n        obj = options.plainObjects ? Object.create(null) : {};\n        var cleanRoot = root.charAt(0) === '[' && root.charAt(root.length - 1) === ']' ? root.slice(1, -1) : root;\n        var index = parseInt(cleanRoot, 10);\n        if (\n            !isNaN(index) &&\n            root !== cleanRoot &&\n            String(index) === cleanRoot &&\n            index >= 0 &&\n            (options.parseArrays && index <= options.arrayLimit)\n        ) {\n            obj = [];\n            obj[index] = parseObject(chain, val, options);\n        } else {\n            obj[cleanRoot] = parseObject(chain, val, options);\n        }\n    }\n\n    return obj;\n};\n\nvar parseKeys = function parseQueryStringKeys(givenKey, val, options) {\n    if (!givenKey) {\n        return;\n    }\n\n    // Transform dot notation to bracket notation\n    var key = options.allowDots ? givenKey.replace(/\\.([^.[]+)/g, '[$1]') : givenKey;\n\n    // The regex chunks\n\n    var brackets = /(\\[[^[\\]]*])/;\n    var child = /(\\[[^[\\]]*])/g;\n\n    // Get the parent\n\n    var segment = brackets.exec(key);\n    var parent = segment ? key.slice(0, segment.index) : key;\n\n    // Stash the parent if it exists\n\n    var keys = [];\n    if (parent) {\n        // If we aren't using plain objects, optionally prefix keys\n        // that would overwrite object prototype properties\n        if (!options.plainObjects && has.call(Object.prototype, parent)) {\n            if (!options.allowPrototypes) {\n                return;\n            }\n        }\n\n        keys.push(parent);\n    }\n\n    // Loop through children appending to the array until we hit depth\n\n    var i = 0;\n    while ((segment = child.exec(key)) !== null && i < options.depth) {\n        i += 1;\n        if (!options.plainObjects && has.call(Object.prototype, segment[1].slice(1, -1))) {\n            if (!options.allowPrototypes) {\n                return;\n            }\n        }\n        keys.push(segment[1]);\n    }\n\n    // If there's a remainder, just add whatever is left\n\n    if (segment) {\n        keys.push('[' + key.slice(segment.index) + ']');\n    }\n\n    return parseObject(keys, val, options);\n};\n\nmodule.exports = function (str, opts) {\n    var options = opts || {};\n\n    if (options.decoder !== null && options.decoder !== undefined && typeof options.decoder !== 'function') {\n        throw new TypeError('Decoder has to be a function.');\n    }\n\n    options.delimiter = typeof options.delimiter === 'string' || utils.isRegExp(options.delimiter) ? options.delimiter : defaults.delimiter;\n    options.depth = typeof options.depth === 'number' ? options.depth : defaults.depth;\n    options.arrayLimit = typeof options.arrayLimit === 'number' ? options.arrayLimit : defaults.arrayLimit;\n    options.parseArrays = options.parseArrays !== false;\n    options.decoder = typeof options.decoder === 'function' ? options.decoder : defaults.decoder;\n    options.allowDots = typeof options.allowDots === 'boolean' ? options.allowDots : defaults.allowDots;\n    options.plainObjects = typeof options.plainObjects === 'boolean' ? options.plainObjects : defaults.plainObjects;\n    options.allowPrototypes = typeof options.allowPrototypes === 'boolean' ? options.allowPrototypes : defaults.allowPrototypes;\n    options.parameterLimit = typeof options.parameterLimit === 'number' ? options.parameterLimit : defaults.parameterLimit;\n    options.strictNullHandling = typeof options.strictNullHandling === 'boolean' ? options.strictNullHandling : defaults.strictNullHandling;\n\n    if (str === '' || str === null || typeof str === 'undefined') {\n        return options.plainObjects ? Object.create(null) : {};\n    }\n\n    var tempObj = typeof str === 'string' ? parseValues(str, options) : str;\n    var obj = options.plainObjects ? Object.create(null) : {};\n\n    // Iterate over the keys and setup the new object\n\n    var keys = Object.keys(tempObj);\n    for (var i = 0; i < keys.length; ++i) {\n        var key = keys[i];\n        var newObj = parseKeys(key, tempObj[key], options);\n        obj = utils.merge(obj, newObj, options);\n    }\n\n    return utils.compact(obj);\n};\n"]}